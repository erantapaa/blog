<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/3.0.2/tocbot.min.js"></script>
<script>
  (function () {
    var toc = document.querySelector('nav[role=navigation]')
    var content = document.querySelector('article[role=main]')

    if (!toc || !content) return;

    tocbot.init({
      tocSelector: '#toc',
      contentSelector: 'article[role=main]',
      headingSelector: 'h1,h2,h3,h4,h5,h6',
      collapseDepth: 6
    })

    let position = ''
    window.addEventListener('scroll', function () {
      var scroll = document.body.scrollTop
      var bbox = content.getBoundingClientRect()
      var newPosition
      if (scroll + bbox.top - window.scrollY < 0) {
        newPosition = 'fixed'
      } else {
        newPosition = ''
      }

      if (newPosition !== position) {
        toc.style.position = newPosition
        position = newPosition
      }
    })
  })()
</script>

